<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<mapper namespace="PostDAO">
 
    <select id="postList" resultType="postVO">
        SELECT *
		FROM post
		ORDER BY pk DESC
    </select>
    
    <!-- 게시판 종류별 쿼리 start-->
    <select id="freeList" resultType="postVO">
        SELECT 
			p.title, p.cover_img, p.view_count, p.create_at, p.is_delete, p.pk, u.name
		FROM 
			post AS p
			JOIN
				user_info AS u
				ON p.user_pk = u.pk
		ORDER BY p.pk DESC
    </select>
    
    <select id="noticeList" resultType="postVO">
        SELECT *
		FROM post
		WHERE kind = 3
		ORDER BY pk DESC
    </select>
    <!-- 게시판 종류별 쿼리 end -->
    
    <select id="createPost" resultType="postVO">
    	INSERT INTO 
			post
		(
			user_pk,
			title,
			description,
			url,
			like_count,
			view_count,
			cover_img,
			kind
		)
			VALUES
		(
			#{user_pk},
			#{title},
			#{description},
			#{url},
			#{like_count},			
			#{view_count},
			#{cover_img},
			#{kind}
		);
    </select>
    
    <select id="deletePost" resultType="postVO">
        DELETE FROM post
        WHERE pk = #{pk}
    </select>
    
    <select id="selectPost" resultType="postVO">
        SELECT 
			p.url, p.title, p.description, p.view_count, p.create_at, p.update_at, p.like_count, p.pk, u.name
		FROM 
			post AS p
			JOIN
				user_info AS u
				ON p.user_pk = u.pk
		WHERE p.pk = #{pk}
    </select>
    
    <select id="update_view" resultType="postVO">
        UPDATE post 
		SET view_count = view_count + 1
		WHERE pk = #{pk};
    </select>
    
    <select id="is_delete" resultType="postVO">
        UPDATE post 
		SET is_delete = 1
		WHERE pk = #{pk};
    </select>
     
    <select id="modifyPost" resultType="postVO">
        UPDATE post 
		SET 
			title = #{title}, 
			description = #{description}, 
			url = #{url},
			cover_img = #{cover_img},
			kind = #{kind},
			update_at = #{update_at}
		WHERE pk = #{pk};
    </select>
    
</mapper>

